{% extends "./base.html" %}

{% block body %}
    {% block main %}
<style>
</style>

{% if status == "ok" %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle"></i> <strong>Upload successful!</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
{% endif %}

{% if status == "error" %}
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <i class="fas fa-exclamation-triangle"></i> Upload was <strong> NOT </strong> successful!
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
{% endif %}

<div class="row">

    <div class="col-md-3"></div>
    <div class="col-md-6 mt-3">
        <h4>Upload Findings</h4>
        <form class="row g-3" action="/findings/upload" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="col-12">
                You can upload one or more SARIF files, or a file archive containing both SARIF
                files and source code.
            </div>
            <div class="col-12">
                <label for="uploadFiles" class="form-label">Files to Upload</label>
                <input type="file" multiple="true" class="form-control" id="uploadFiles" name="file[]" accept="application/sarif+json, application/zip, application/gzip, application/x-zip, .sarif, .json, .zip, .tar.gz, .tar.xz, .tgz" required="true">
            </div>
            <div class="col-12">
                <label for="packageURL" class="form-label">Package URL (with version)</label>
                <input type="text" class="form-control" id="packageURL" required="true" name="package_url" placeholder="pkg:npm/left-pad@1.3.0">
            </div>
            <div class="col-12">
                <button type="submit" class="btn btn-primary">Add</button>
            </div>
        </form>
    </div>
    <div class="col-md-3"></div>
</div>
    {% endblock main %}
{% endblock body %}
